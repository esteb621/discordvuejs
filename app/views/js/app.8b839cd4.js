(function(){"use strict";var e={1942:function(e,t,s){var a=s(9242),n=s(3396);function r(e,t){const s=(0,n.up)("router-view");return(0,n.wg)(),(0,n.j4)(s)}var o=s(89);const l={},i=(0,o.Z)(l,[["render",r]]);var u=i,c=s(2483);const d=e=>((0,n.dD)("data-v-2ce8f7a6"),e=e(),(0,n.Cn)(),e),m={id:"home",class:"flex flex-col items-end bg-gray-900 h-screen"},p={class:"container text-white self-center flex justify-center items-center h-screen"},g={class:"row justify-center"},f={class:"text-center w-screen"},v=d((()=>(0,n._)("h1",{class:"opacity-0 m-4 font-bold text-5xl animate-slide-in animation-delay-200"}," Bienvenue sur Discord! ",-1))),h=d((()=>(0,n._)("h2",{class:"opacity-0 font-light text-xl mb-5 animate-slide-in animation-delay-500"}," Inscrivez-vous ou connectez-vous pour commencer ",-1))),w={class:"self-center"},x=d((()=>(0,n._)("div",{id:"credits",class:"opacity-0 p-2 mt-auto self-start text-white animate-slide-in animation-delay-1000"},[(0,n.Uk)(" Développé par "),(0,n._)("a",{href:"",class:"underline"},"Esteban Vangi"),(0,n.Uk)(", "),(0,n._)("a",{href:"",class:"underline"},"Pierre Pujos"),(0,n.Uk)(" et "),(0,n._)("a",{href:"",class:"underline"},"Lucas Buonocore")],-1)));function y(e,t){const s=(0,n.up)("RouterLink");return(0,n.wg)(),(0,n.iD)("section",m,[(0,n._)("div",p,[(0,n._)("div",g,[(0,n._)("div",f,[v,h,(0,n._)("div",w,[(0,n.Wm)(s,{to:"/login",class:"opacity-0 bg-blue-500 text-white text-xl font-bold rounded-lg py-3 px-6 m-2 hover:bg-blue-600 duration-200 animate-slide-in animation-delay-700"},{default:(0,n.w5)((()=>[(0,n.Uk)(" Se connecter ")])),_:1}),(0,n.Wm)(s,{to:"/register",class:"opacity-0 bg-gray-500 text-white text-xl font-bold rounded-lg py-3 px-6 hover:bg-gray-600 duration-200 animate-slide-in animation-delay-700"},{default:(0,n.w5)((()=>[(0,n.Uk)(" S'inscrire ")])),_:1})])])])]),x])}const b={},_=(0,o.Z)(b,[["render",y],["__scopeId","data-v-2ce8f7a6"]]);var k=_,U={__name:"HomeView",setup(e){return(e,t)=>((0,n.wg)(),(0,n.j4)(k))}};const q=U;var S=q,C=(s(7658),s(4870)),P=s(7139),j=s(65),D=s(5708),H=s(7629);const I=e=>((0,n.dD)("data-v-2211c8a8"),e=e(),(0,n.Cn)(),e),V={class:"flex justify-center items-center text-left bg-cover bg-center"},W={id:"login",class:"shadow-lg shadow-gray-600 p-6 rounded-lg bg-gray-700 max-h-75 overflow-y-auto"},M=I((()=>(0,n._)("h1",{class:"mb-2 text-white text-center text-3xl font-semibold"},"Content de te revoir!",-1))),L=I((()=>(0,n._)("h2",{class:"text-center text-xl font-semibold"},"Renseigne tes identifiants pour te connecter",-1))),R={class:"mt-4 text-start"},T={class:"grid grid-cols-12 mb-3"},N={class:"col-span-12"},z=I((()=>(0,n._)("label",{for:"username",class:"mb-2 text-white font-semibold text-base"},"Nom d'utilisateur *",-1))),B={class:"grid grid-cols-12 mb-3"},Z={class:"col-span-12"},O=I((()=>(0,n._)("label",{for:"password",class:"text-white font-semibold text-base"},"Mot de passe *",-1))),E=["disabled"],$={key:0},A={key:1},F={key:0,class:"text-red-700 font-bold text-bold col-span-12 text-center mt-3"},Y={class:"text-capitalize mt-3"},K={class:"pl-2 text-center"};var J={__name:"LoginForm",setup(e){const t=(0,j.oR)(),s=(0,c.tv)(),a=H.Ry().shape({username:H.Z_().required("Un nom d'utilisateur est requis!"),password:H.Z_().required("Un mot de passe est requis!")}),r=(0,C.iH)(""),o=(0,C.iH)(""),l=(0,C.iH)(""),i=(0,C.iH)(!1),u=(0,C.iH)("#5c6aff"),d=(0,C.iH)("#3aa55c"),m=()=>!(r.value&&o.value);function p(e){i.value=!0,t.dispatch("auth/login",e).then((()=>{i.value=!1,s.push("/main")})).catch((e=>{i.value=!1,l.value=e}))}return(e,t)=>{const s=(0,n.up)("font-awesome-icon"),c=(0,n.up)("RouterLink");return(0,n.wg)(),(0,n.iD)("main",V,[(0,n._)("div",W,[M,L,(0,n._)("div",R,[(0,n.Wm)((0,C.SU)(D.l0),{class:"form-group",onSubmit:p,"validation-schema":(0,C.SU)(a)},{default:(0,n.w5)((()=>[(0,n._)("div",T,[(0,n._)("div",N,[z,(0,n.Wm)((0,C.SU)(D.gN),{modelValue:r.value,"onUpdate:modelValue":t[0]||(t[0]=e=>r.value=e),ref:"usernameInput",type:"username",id:"username",name:"username",required:"",class:"text-white bg-colors-gray-form border-none w-full px-4 py-2 rounded-md border focus:outline-none"},null,8,["modelValue"]),(0,n.Wm)((0,C.SU)(D.Bc),{name:"username",class:"text-red-700 font-bold"})])]),(0,n._)("div",B,[(0,n._)("div",Z,[O,(0,n.Wm)((0,C.SU)(D.gN),{modelValue:o.value,"onUpdate:modelValue":t[1]||(t[1]=e=>o.value=e),ref:"passwordInput",type:"password",id:"password",name:"password",required:"",class:"text-white bg-colors-gray-form w-full px-4 py-2 rounded-md border-none focus:outline-none"},null,8,["modelValue"]),(0,n.Wm)((0,C.SU)(D.Bc),{name:"password",class:"text-red-700 font-bold"})])]),(0,n._)("button",{class:(0,P.C_)([{"bg-green-500 cursor-wait":i.value},"mt-5 block w-full px-4 py-2 rounded-md font-bold text-white cursor-pointer disabled:opacity-50 disabled:cursor-not-allowed bg-blue-500 hover:bg-blue-600 duration-200"]),disabled:m(),style:(0,P.j5)({backgroundColor:i.value?d.value:u.value}),type:"submit"},[i.value?(0,n.kq)("",!0):((0,n.wg)(),(0,n.iD)("span",$,"Connexion")),i.value?((0,n.wg)(),(0,n.iD)("span",A,[(0,n.Wm)(s,{icon:["fas","spinner"],spin:""})])):(0,n.kq)("",!0)],14,E),l.value?((0,n.wg)(),(0,n.iD)("p",F,(0,P.zw)(l.value),1)):(0,n.kq)("",!0)])),_:1},8,["validation-schema"])]),(0,n._)("div",Y,[(0,n._)("p",K,[(0,n.Uk)(" Besoin d'un compte ? "),(0,n.Wm)(c,{to:"/register",class:"text-blue-500"},{default:(0,n.w5)((()=>[(0,n.Uk)("S'inscrire")])),_:1})])])])])}}};const G=(0,o.Z)(J,[["__scopeId","data-v-2211c8a8"]]);var X=G,Q={__name:"LoginView",setup(e){return(e,t)=>((0,n.wg)(),(0,n.j4)(X))}};const ee=Q;var te=ee;const se=e=>((0,n.dD)("data-v-4bf9fd1c"),e=e(),(0,n.Cn)(),e),ae={class:"flex justify-center items-center text-left bg-cover bg-center"},ne={id:"login",class:"max-w-xl shadow-lg shadow-gray-600 p-6 rounded-lg bg-gray-700 max-h-fit overflow-y-auto"},re=se((()=>(0,n._)("h1",{class:"mb-2 text-white text-center text-3xl font-semibold"},"Ravi de faire ta connaissance!",-1))),oe=se((()=>(0,n._)("h2",{class:"text-center text-xl font-semibold"},"Merci de renseigner les informations suivantes pour mieux te connaitre",-1))),le={class:"mt-4 text-start"},ie={class:"grid grid-cols-12 mb-3"},ue={class:"col-span-12"},ce=se((()=>(0,n._)("label",{for:"username",class:"mb-2 text-white font-semibold text-base"},"Nom d'utilisateur *",-1))),de={class:"grid grid-cols-12 mb-3"},me={class:"col-span-12"},pe=se((()=>(0,n._)("label",{for:"email",class:"text-white font-semibold text-base"},"Adresse mail *",-1))),ge={class:"grid grid-cols-12 mb-3"},fe={class:"col-span-12"},ve=se((()=>(0,n._)("label",{for:"password",class:"text-white font-semibold text-base"},"Mot de passe *",-1))),he={class:"mb-3"},we=se((()=>(0,n._)("span",{class:"mb-2 text-white font-semibold"},"Votre mot de passe doit contenir au moins:",-1))),xe={class:"list-none text-white"},ye={class:"grid grid-cols-12 mb-3"},be={class:"col-span-12"},_e=se((()=>(0,n._)("label",{for:"retypePassword",class:"text-white font-semibold text-base"}," Confirmer le mot de passe * ",-1))),ke={class:"mt-4 w-full"},Ue={class:"col-span-12"},qe=se((()=>(0,n._)("label",{for:"profile_picture",class:"text-white font-semibold text-base"},"Photo de profil (optionnel)",-1))),Se=["disabled"],Ce={key:0},Pe={key:1},je={key:0,class:"text-red-700 font-bold col-span-12 text-center mt-3"},De={class:"text-capitalize mt-3"},He={class:"pl-2 text-center"};var Ie={__name:"RegisterForm",setup(e){const t=(0,j.oR)(),s=(0,c.tv)(),a=H.Ry().shape({username:H.Z_().required("Un nom d'utilisateur est requis!").min(3,"Le pseudo doit faire 3 caractères minimum!").max(20,"Le pseudo doit faire 20 characteres maximum!"),email:H.Z_().required("Un email est requis!").email("Cet email n'est pas valide!").max(50,"Cet email est trop long!"),password:H.Z_().required("Un mot de passe est requis!").min(8,"Le mot de passe doit contenir au moins 8 caractères!").matches(/[$&+.,:;=?@#|'"<>^*ඞ()%!-]/,"Le mot de passe doit contenir au moins un chiffre et un caractère spécial"),confirmPassword:H.Z_().required("Ce champ est obligatoire!").oneOf([H.iH("password"),null],"Les mots de passe doivent être identiques"),picture:H.Z_().nullable()}),r=(0,C.iH)(""),o=(0,C.iH)(""),l=(0,C.iH)(""),i=(0,C.iH)(""),u=(0,C.iH)(null);let d=(0,C.iH)("");const m=(0,C.iH)(!1),p=(0,C.iH)("#5c6aff"),g=(0,C.iH)("#3aa55c"),f=()=>!(r.value&&o.value&&l.value&&i.value);function v(){return o.value.length>=8}function h(){const e=/\d/;return e.test(o.value)}function w(){const e=/[$&+.,:;=?@#|'"<>^*ඞ()%!-]/;return e.test(o.value)}function x(e){d.value="",m.value=!0,t.dispatch("auth/register",e).then((e=>{console.log("compté crée"),m.value=!1,d.value=e.data,s.push("/main")})).catch((e=>{m.value=!1,d.value=e}))}return(e,t)=>{const s=(0,n.up)("font-awesome-icon"),c=(0,n.up)("RouterLink");return(0,n.wg)(),(0,n.iD)("main",ae,[(0,n._)("div",ne,[re,oe,(0,n._)("div",le,[(0,n.Wm)((0,C.SU)(D.l0),{class:"form-group",onSubmit:x,"validation-schema":(0,C.SU)(a)},{default:(0,n.w5)((()=>[(0,n._)("div",ie,[(0,n._)("div",ue,[ce,(0,n.Wm)((0,C.SU)(D.gN),{modelValue:r.value,"onUpdate:modelValue":t[0]||(t[0]=e=>r.value=e),ref:"usernameInput",type:"username",id:"username",name:"username",required:"",class:"text-white bg-colors-gray-form border-none w-full px-4 py-2 rounded-md border focus:outline-none"},null,8,["modelValue"]),(0,n.Wm)((0,C.SU)(D.Bc),{name:"username",class:"text-red-700 font-bold"})])]),(0,n._)("div",de,[(0,n._)("div",me,[pe,(0,n.Wm)((0,C.SU)(D.gN),{ref:"emailInput",modelValue:i.value,"onUpdate:modelValue":t[1]||(t[1]=e=>i.value=e),type:"email",id:"email",name:"email",required:"",class:"text-white bg-colors-gray-form w-full px-4 py-2 rounded-md border-none focus:outline-none"},null,8,["modelValue"]),(0,n.Wm)((0,C.SU)(D.Bc),{name:"email",class:"text-red-700 font-bold"})])]),(0,n._)("div",ge,[(0,n._)("div",fe,[ve,(0,n.Wm)((0,C.SU)(D.gN),{modelValue:o.value,"onUpdate:modelValue":t[2]||(t[2]=e=>o.value=e),ref:"passwordInput",type:"password",id:"password",name:"password",required:"",class:"text-white bg-colors-gray-form w-full px-4 py-2 rounded-md border-none focus:outline-none"},null,8,["modelValue"]),(0,n.Wm)((0,C.SU)(D.Bc),{name:"password",class:"text-red-700 font-bold"})])]),(0,n._)("div",he,[we,(0,n._)("ul",xe,[(0,n._)("li",{class:(0,P.C_)({"text-green-600":v()})},[v()?((0,n.wg)(),(0,n.j4)(s,{key:0,icon:["fa","check"],class:"text-green-600"})):(0,n.kq)("",!0),(0,n.Uk)(" 8 caractères ")],2),(0,n._)("li",{class:(0,P.C_)({"text-green-600":h()})},[h()?((0,n.wg)(),(0,n.j4)(s,{key:0,icon:["fa","check"],class:"text-green-600"})):(0,n.kq)("",!0),(0,n.Uk)(" Un chiffre ")],2),(0,n._)("li",{class:(0,P.C_)({"text-green-600":w()})},[w()?((0,n.wg)(),(0,n.j4)(s,{key:0,icon:["fa","check"],class:"text-green-600"})):(0,n.kq)("",!0),(0,n.Uk)(" Un caractère spécial ")],2)])]),(0,n._)("div",ye,[(0,n._)("div",be,[_e,(0,n.Wm)((0,C.SU)(D.gN),{modelValue:l.value,"onUpdate:modelValue":t[3]||(t[3]=e=>l.value=e),type:"password",id:"retypePassword",name:"confirmPassword",required:"true",class:"bg-colors-gray-form text-white w-full px-4 py-2 rounded-md border-none focus:border-blue-500 focus:outline-none"},null,8,["modelValue"]),(0,n.Wm)((0,C.SU)(D.Bc),{name:"confirmPassword",class:"text-red-700 font-bold"})])]),(0,n._)("div",ke,[(0,n._)("div",Ue,[qe,(0,n.Wm)((0,C.SU)(D.gN),{modelValue:u.value,"onUpdate:modelValue":t[4]||(t[4]=e=>u.value=e),name:"picture",type:"file",accept:".jpg,.jpeg,.gif,.png,.heic",id:"profile_picture",class:"w-full"},null,8,["modelValue"])])]),(0,n._)("button",{disabled:f(),class:(0,P.C_)([{"bg-green-500 cursor-wait":m.value},"mt-5 block w-full px-4 py-2 rounded-md font-bold text-white cursor-pointer disabled:opacity-50 disabled:cursor-not-allowed bg-blue-500 hover:bg-blue-600 duration-200"]),style:(0,P.j5)({backgroundColor:m.value?g.value:p.value}),type:"submit"},[m.value?(0,n.kq)("",!0):((0,n.wg)(),(0,n.iD)("span",Ce,"Inscription")),m.value?((0,n.wg)(),(0,n.iD)("span",Pe,[(0,n.Wm)(s,{icon:["fas","spinner"],spin:""})])):(0,n.kq)("",!0)],14,Se)])),_:1},8,["validation-schema"]),(0,C.SU)(d)?((0,n.wg)(),(0,n.iD)("p",je,(0,P.zw)((0,C.SU)(d)),1)):(0,n.kq)("",!0)]),(0,n._)("div",De,[(0,n._)("p",He,[(0,n.Uk)(" Déjà inscrit ? "),(0,n.Wm)(c,{class:"text-blue-500",to:"/login"},{default:(0,n.w5)((()=>[(0,n.Uk)("Connexion")])),_:1})])])])])}}};const Ve=(0,o.Z)(Ie,[["__scopeId","data-v-4bf9fd1c"]]);var We=Ve,Me={__name:"SignUpView",setup(e){return(e,t)=>((0,n.wg)(),(0,n.j4)(We))}};const Le=Me;var Re=Le;const Te={class:"text-gray-300 hover:text-gray-200 grow"},Ne={key:0,class:"mr-auto"};var ze={__name:"ChannelComponent",props:{name:String,id:Number,admin:Boolean,typologie:Number},emits:["delete-channel"],setup(e,{emit:t}){const s=e;function a(){t("delete-channel",s.id)}return(t,r)=>{const o=(0,n.up)("font-awesome-icon"),l=(0,n.up)("router-link");return(0,n.wg)(),(0,n.j4)(l,{to:"/main/server/channel/"+e.id,class:(0,P.C_)([{active:t.$route.path==="/main/server/channel/"+e.id},"rounded-md w-90 py-2 px-3 mb-3 mx-2 font-bold focus:text-gray-300 hover:cursor-pointer hover:bg-gray-600 flex flex-row items-center space-x-2"])},{default:(0,n.w5)((()=>[(0,n.Wm)(o,{icon:["fa","hashtag"],size:"lg",class:"text-gray-400"}),(0,n._)("p",Te,(0,P.zw)(s.name),1),e.admin?((0,n.wg)(),(0,n.iD)("div",Ne,[(0,n.Wm)(o,{onClick:a,icon:["fa","trash"],size:"sm",class:"text-gray-400 cursor-pointer hover:text-gray-300"})])):(0,n.kq)("",!0)])),_:1},8,["to","class"])}}};const Be=(0,o.Z)(ze,[["__scopeId","data-v-43f8bfc6"]]);var Ze=Be;const Oe=(0,n._)("a",{class:"animate-pulse rounded-md w-58 h-10 py-2 px-3 mb-3 mx-2 bg-gray-600"},null,-1),Ee=(0,n._)("a",{class:"animate-pulse rounded-md w-24 h-10 py-2 px-3 mb-3 mx-2 bg-gray-600"},null,-1),$e=(0,n._)("a",{class:"animate-pulse rounded-md w-40 h-10 py-2 px-3 mb-3 mx-2 bg-gray-600"},null,-1);function Ae(e,t){return(0,n.wg)(),(0,n.iD)(n.HY,null,[Oe,Ee,$e],64)}const Fe={},Ye=(0,o.Z)(Fe,[["render",Ae]]);var Ke=Ye,Je=s(6265),Ge=s.n(Je);class Xe{getLocalRefreshToken(){const e=ht.getters["auth/getUser"];return e?.refreshToken}getLocalAccessToken(){const e=ht.getters["auth/getUser"];return e?.accessToken}updateLocalAccessToken(e){let t=ht.getters["auth/getUser"];t.accessToken=e,localStorage.setItem("user",JSON.stringify(t))}getUser(){return ht.getters["auth/getUser"]}setUser(e){localStorage.setItem("user",JSON.stringify(e))}removeUser(){localStorage.removeItem("user")}}var Qe=new Xe;class et{async login(e){return xt.post("../auth/login",{username:e.username,password:e.password}).then((e=>(e.data.accessToken&&Qe.setUser(e.data),e.data))).catch((e=>e.response.data.message))}async register(e){const t=new FormData;return t.append("username",e.username),t.append("email",e.email),t.append("password",e.password),t.append("profilePicture",e.profilePicture),xt.post("../auth/register",t,{headers:{"Content-Type":"multipart/form-data"}}).then((e=>(e.data.accessToken&&Qe.setUser(e.data),e.data))).catch((e=>e.response.data.message))}logout(){Qe.removeUser()}}var tt=new et;class st{async uploadProfilePic(e,t){const s=new FormData;return s.append("picture",t),s.append("id",e),xt.post("../picture/upload",s,{headers:{"Content-Type":"multipart/form-data"}}).then((async e=>e.data)).catch((e=>e.response.data.message))}async getProfilePicture(e){return xt.get(`../picture/${e}`).then((e=>e.data.picture)).catch((e=>e.response.data.message))}}var at=new st;const nt=JSON.parse(localStorage.getItem("user")),rt=nt?{status:{loggedIn:!0},user:nt}:{status:{loggedIn:!1},user:null},ot={namespaced:!0,state:rt,actions:{async login({commit:e},t){return tt.login(t).then((t=>t.accessToken?(e("loginSuccess",t),Promise.resolve(t)):(e("loginFailure"),Promise.reject(t))))},logout({commit:e}){tt.logout(),e("logout")},async register({commit:e},t){return tt.register(t).then((s=>(console.log(s),t.picture&&at.uploadProfilePic(s.id,t.picture),s.accessToken?(console.log(s.accessToken),e("registerSuccess",s),Promise.resolve(s)):(e("registerFailure"),Promise.reject(s)))))},refreshToken({commit:e},t){e("refreshToken",t)}},mutations:{loginSuccess(e,t){e.status.loggedIn=!0,e.user=t},loginFailure(e){e.status.loggedIn=!1,e.user=null},logout(e){e.status.loggedIn=!1,e.user=null},registerSuccess(e,t){e.status.loggedIn=!0,e.user=t},registerFailure(e){e.status.loggedIn=!1},setToken(e,t){e.user.accessToken=t},refreshToken(e,t){e.status.loggedIn=!0,e.user={...e.user,accessToken:t}}},getters:{getUser:e=>e.user||""}},lt={on(e,t){document.addEventListener(e,(e=>t(e.detail)))},dispatch(e,t){document.dispatchEvent(new CustomEvent(e,{detail:t}))},remove(e,t){document.removeEventListener(e,t)}};var it=lt;class ut{async sendMessage(e,t,s){await xt.post("/createMessage",{user_id:e,channel_id:t,text:s}).then((e=>e)).catch((e=>{console.warn(e)}))}async getMessages(e){const t=await xt.get("/messages/channel/"+e);console.log(t);const s=t.data.map((e=>({id:e.id,channel:e.channel_id,user:e.user_id,text:e.text})));return s}}var ct=new ut;const dt={namespaced:!0,state:(0,C.qj)({messages:{},channelNames:{}}),actions:{async fetchMessages({commit:e},t){await ct.getMessages(t).then((async s=>{const a=s,n=await bt.getChannelName(t);e("setMessages",{channelId:t,messages:a}),e("setChannelName",{channelId:t,name:n})})).catch((e=>{e.response&&403===e.response.status&&it.dispatch("logout")}))}},mutations:{setMessages(e,{channelId:t,messages:s}){e.messages[t]=s},setChannelName(e,{channelId:t,name:s}){e.channelNames[t]=s}},getters:{getMessagesByChannelId:e=>t=>e.messages[t],getChannelNameById:e=>t=>e.channelNames[t]}};class mt{async getUserById(e){const t=await xt.get("/user/"+e),s=t.data;return s}async getUsers(){const e=await xt.get("/users"),t=e.data.map((e=>({id:e.id,username:e.username,picture:e.picture})));return t}async updateProfile(e,t){try{const s=await xt.put(`/update/users/${e}`,{username:t.username,password:t.password,email:t.email});return s.data.message}catch(s){throw s.response.data.message}}async updatePassword(e,t){try{const s=await xt.put(`/update/password/${e}`,{currentPassword:t.currentPassword,newPassword:t.newPassword});return s.data.message}catch(s){throw s.response.data.message}}async deleteAccount(e){try{await xt.delete(`../picture/delete/${e}`);const t=xt.delete(`/delete/users/${e}`);return t}catch(t){throw t.response.data.message}}async addFriend(e,t){await xt.post("/createFriend",{user1_id:e,user2:t,published:1}).then((e=>e.data)).catch((e=>{throw console.warn(e),e.response.data.message}))}async isFriend(e){const t=await xt.get(`/friend/${e}`);return""!==t.data}async getPrivateMessages(e){const t=await xt.get(`/channels/private/${e}`),s=t.data.map((e=>({id:e.id,nom:e.nom})));return s}}var pt=new mt;const gt={namespaced:!0,state:(0,C.qj)({users:[],pictures:[]}),actions:{async fetchUser({commit:e},t){const s=await pt.getUserById(t);e("setUsername",{userId:t,username:s.username})},async fetchPicture({commit:e},t){const s=await at.getProfilePicture(t);e("setPicture",{userId:t,picture:s})}},mutations:{setUsername(e,{userId:t,username:s}){e.users[t]=s},setPicture(e,{userId:t,picture:s}){e.pictures[t]=s}},getters:{getUsername:e=>t=>e.users[t],getPicture:e=>t=>e.pictures[t]}},ft={namespaced:!0,state:(0,C.qj)({channels:[],privateMessages:[]}),actions:{async fetchChannels({commit:e}){await bt.getChannels().then((async t=>{const s=t;e("setChannels",{channels:s})})).catch((e=>{e.response&&403===e.response.status&&it.dispatch("logout")}))},async fetchPrivateMessages({commit:e},t){await pt.getPrivateMessages(t).then((async t=>{e("setPrivateMessages",{channels:t})})).catch((e=>{e.response&&403===e.response.status&&it.dispatch("logout")}))}},mutations:{setChannels(e,{channels:t}){e.channels=t},setPrivateMessages(e,{channels:t}){console.log(t),e.privateChannels=t}},getters:{getChannels:e=>e.channels,getPrivateMessages:e=>e.privateChannels}},vt=(0,j.MT)({modules:{auth:ot,message:dt,channel:ft,user:gt}});var ht=vt;const wt=Ge().create({baseURL:"/api/discord"});wt.interceptors.request.use((e=>{const t=Qe.getLocalAccessToken();return t&&(e.headers["userId"]=ht.getters["auth/getUser"].id,e.headers["x-access-token"]=t),e}),(e=>Promise.reject(e))),wt.interceptors.response.use((e=>e),(async e=>{const t=e.config;if("../auth/login"!==t.url&&e.response&&401===e.response.status&&!t._retry){t._retry=!0;try{const e=await wt.post("../auth/refreshtoken",{refreshToken:Qe.getLocalRefreshToken()}),{accessToken:s}=e.data;return ht.dispatch("auth/refreshToken",s),Qe.updateLocalAccessToken(s),console.log("Access Token mis a jour!"),wt(t)}catch(s){return Promise.reject(s)}}return Promise.reject(e)}));var xt=wt;class yt{async getChannels(){const e=await xt.get("/channels/1"),t=e.data.map((e=>({id:e.id,nom:e.nom})));return t}async getChannelName(e){const t=await xt.get("/channel/"+e),s=t.data.nom;return s}async addChannel(e){await xt.post("/createChannel",{nom:e}).then((e=>e.data)).catch((e=>{throw e.response.data.message}))}async addPrivateChannel(e){await xt.post("/createPrivateChannel",{nom:e}).then((e=>e.data)).catch((e=>{throw e.response.data.message}))}async deleteChannel(e){try{const t=await xt.delete(`/delete/channels/${e}`);return t.data}catch(t){throw t.response.data.message}}}var bt=new yt;const _t={class:"w-100 flex-grow bg-gray-800"},kt={class:"mt-4 p-2 pl-3 text-left text-xs cursor-default text-gray-500 hover:text-gray-300 font-bold uppercase"},Ut={id:"channels-list",class:"text-left flex flex-col overflow-y-auto"},qt={key:0},St=["onKeyup"],Ct={key:1,class:""},Pt={key:0};var jt={__name:"ChannelsList",emits:["info-message"],setup(e,{emit:t}){const s=(0,C.iH)(null),r=(0,C.iH)("Salons textuels"),o=(0,C.iH)(!1),l=(0,C.iH)(!1),i=(0,C.iH)(""),u=(0,C.iH)(!1),d=(0,C.iH)(!1),m=(0,C.iH)(!1),p=(0,c.tv)(),g=(0,j.oR)(),f=(0,C.iH)("");(0,n.m0)((async()=>{const e=p.currentRoute.value;if(e.path.includes("server")&&(r.value="Salons textuels",0===Object.keys(g.getters["channel/getChannels"]).length&&g.dispatch("channel/fetchChannels"),s.value=g.getters["channel/getChannels"],g.getters["auth/getUser"]&&await pt.getUserById(g.getters["auth/getUser"].id).then((e=>{2==e.role_id&&(u.value=!0)})).catch((e=>{console.warn(e.response.data.message)}))),1==e.path.includes("personal")){const e=g.getters["auth/getUser"].id;r.value="Messages privés",g.getters["channel/getPrivateMessages"]||g.dispatch("channel/fetchPrivateMessages",e),u.value=!1,s.value=g.getters["channel/getPrivateMessages"],console.log(s.value)}}));const v=async()=>{if(l.value=!0,f.value){const e=g.getters["auth/getUser"].id,a=f.value;await pt.addFriend(e,a).then((async()=>{const n=await pt.isFriend(a);if(!n){const n="channel_"+e+"_"+a;await bt.addPrivateChannel(n).then((()=>{g.dispatch("channel/fetchPrivateMessages",e),s.value=g.getters["channel/getPrivateMessages"],f.value=""})).catch((e=>{t("info-message",e)}))}t("info-message",`L'utilisateur ${a} a bien été ajouté comme ami!`)})).catch((e=>{t("info-message",e)}))}l.value=!1},h=async()=>{if(i.value&&!s.value.includes(i.value))try{await bt.addChannel(i.value).then((e=>{s.value.push(e),d.value=!1,t("info-message",`Le channel ${i.value} a bien été crée!`)}))}catch(e){t("info-message",e)}};async function w(e){await bt.deleteChannel(e).then((async e=>{g.dispatch("channel/fetchChannels"),p.push("./1"),t("info-message",e.message)})).catch((e=>{t("info-message",e)}))}return(e,t)=>{const c=(0,n.up)("font-awesome-icon");return(0,n.wg)(),(0,n.iD)("div",_t,[(0,n._)("p",kt,[(0,n.Uk)((0,P.zw)(r.value)+" ",1),u.value&&"/main/server"===(0,C.SU)(p).currentRoute.value.path?((0,n.wg)(),(0,n.iD)("span",{key:0,onClick:t[0]||(t[0]=e=>d.value=!0),class:"text-gray-100 opacity-50 cursor-pointer hover:opacity-100 p-1 transition-all duration-200 ease-linear",id:"plus"},[(0,n.Wm)(c,{icon:["fa","plus"],size:"lg"})])):(0,n.kq)("",!0),"/main/personal"===(0,C.SU)(p).currentRoute.value.path?((0,n.wg)(),(0,n.iD)("span",{key:1,onClick:t[1]||(t[1]=e=>m.value=!0),class:"text-gray-100 opacity-50 cursor-pointer hover:opacity-100 p-1 transition-all duration-200 ease-linear",id:"plus"},[(0,n.Wm)(c,{icon:["fa","plus"],size:"lg"})])):(0,n.kq)("",!0)]),(0,n._)("div",Ut,[o.value?(0,n.kq)("",!0):((0,n.wg)(),(0,n.iD)("div",qt,[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(s.value,((t,s)=>((0,n.wg)(),(0,n.j4)(Ze,{admin:u.value,id:t.id,typologie:e.typologie,key:s,name:t.nom,onDeleteChannel:w},null,8,["admin","id","typologie","name"])))),128)),d.value&&"/main/server"===(0,C.SU)(p).currentRoute.value.path?(0,n.wy)(((0,n.wg)(),(0,n.iD)("input",{key:0,"onUpdate:modelValue":t[2]||(t[2]=e=>i.value=e),type:"text",placeholder:"Nom du salon",onKeyup:[t[3]||(t[3]=(0,a.D2)((e=>{d.value=!1}),["esc"])),(0,a.D2)(h,["enter"])],required:"",title:"Enter",class:"rounded-md w-56 py-2 px-3 mb-3 mx-2 font-bold bg-gray-600 outline-none text-gray-200 flex flex-row items-center space-x-2"},null,40,St)),[[a.nr,i.value]]):(0,n.kq)("",!0),"/main/personal"===(0,C.SU)(p).currentRoute.value.path&&m.value?((0,n.wg)(),(0,n.iD)("div",Ct,[(0,n.wy)((0,n._)("input",{"onUpdate:modelValue":t[4]||(t[4]=e=>f.value=e),type:"text",onKeyup:t[5]||(t[5]=(0,a.D2)((e=>{m.value=!1}),["esc"])),placeholder:"Nom d'utilisateur",class:"rounded-md w-56 py-2 px-3 mb-3 mx-2 font-bold bg-gray-600 outline-none text-gray-200 flex flex-row items-center space-x-2"},null,544),[[a.nr,f.value]]),(0,n._)("button",{onClick:v,class:"rounded-md w-56 py-2 px-3 mr-24 mb-3 mx-2 font-bold hover:bg-green-700 transition-all bg-green-600 text-gray-200"},[l.value?(0,n.kq)("",!0):((0,n.wg)(),(0,n.iD)("span",Pt,"Ajouter l'ami")),l.value?((0,n.wg)(),(0,n.j4)(c,{key:1,icon:["fas","spinner"],spin:"true",size:"lg"})):(0,n.kq)("",!0)])])):(0,n.kq)("",!0)])),o.value?((0,n.wg)(),(0,n.j4)(Ke,{key:1})):(0,n.kq)("",!0)])])}}};const Dt=jt;var Ht=Dt;const It={class:"relative p-2 mb-2"},Vt=["onSubmit"];var Wt={__name:"TextBarComponent",emits:["send-message"],setup(e,{emit:t}){const s=(0,j.oR)(),r=(0,c.tv)(),o=(0,C.iH)("");function l(){if(s.getters["auth/getUser"].id){const e=s.getters["auth/getUser"].id,a=r.currentRoute.value,n=a.params.id||1;t("send-message",e,n,o.value),o.value=""}}return(e,t)=>{const s=(0,n.up)("font-awesome-icon");return(0,n.wg)(),(0,n.iD)("div",It,[(0,n._)("form",{onSubmit:(0,a.iM)(l,["prevent"])},[(0,n.wy)((0,n._)("input",{id:"textbar",type:"text",required:"",autocomplete:"off",class:"shadow-none rounded-md w-full p-3 pr-10 focus:outline-none bg-gray-800 text-gray-400 placeholder:text-gray-400 placeholder:opacity-50 resize-y h-12 min-h-12 max-h-40",placeholder:"Ecrivez votre message...","onUpdate:modelValue":t[0]||(t[0]=e=>o.value=e),"aria-label":"Recipient's username","aria-describedby":"button-addon2"},null,512),[[a.nr,o.value]]),(0,n._)("button",{onClick:l,class:"absolute mt-3 right-0 mr-5 text-rounded-md text-gray-400 hover:text-gray-500 duration-200",type:"button"},[(0,n.Wm)(s,{icon:["fas","paper-plane"]})])],40,Vt)])}}};const Mt=Wt;var Lt=Mt;const Rt={key:0,class:"w-10 h-10 rounded-full bg-gray-600 animate-pulse",alt:"Photo de profil",id:"profile-picture"},Tt=["src"];var Nt={__name:"UserPicture",props:{id:{type:Number},link:{type:String}},setup(e){const t=e,s=(0,j.oR)();let a=(0,C.iH)(t.link),r=(0,C.iH)(t.id).value,o=(0,C.iH)(!1);return(0,n.bv)((async()=>{o.value=!0,s.getters["user/getPicture"](r)||await s.dispatch("user/fetchPicture",r),a.value=s.getters["user/getPicture"](r),o.value=!1})),(e,t)=>((0,n.wg)(),(0,n.iD)(n.HY,null,[(0,C.SU)(o)?((0,n.wg)(),(0,n.iD)("div",Rt)):(0,n.kq)("",!0),(0,C.SU)(o)?(0,n.kq)("",!0):((0,n.wg)(),(0,n.iD)("img",{key:1,class:"w-10 h-10 rounded-full",src:(0,C.SU)(a),alt:"Photo de profil",id:"profile-picture"},null,8,Tt))],64))}};const zt=Nt;var Bt=zt;const Zt={id:"message",class:"flex flex-row mb-3"},Ot={class:"flex-shrink-0 p-2 ml-3"},Et={class:"p-2 flex flex-col flex-wrap text-left"},$t={key:0,class:"w-16 h-6 rounded-md bg-gray-600 animate-pulse"},At={key:1};var Ft={__name:"MessageComponent",props:{userId:{type:Number,required:!0},message:{type:String,required:!0}},setup(e){const t=e,s=(0,j.oR)(),a=(0,C.iH)(t.userId).value,r=(0,C.iH)(t.message),o=(0,C.iH)("");return(0,n.bv)((async()=>{s.getters["user/getUsername"](a)||await s.dispatch("user/fetchUser",a),o.value=s.getters["user/getUsername"](a)})),(e,t)=>((0,n.wg)(),(0,n.iD)("div",Zt,[(0,n._)("div",Ot,[(0,n.Wm)(Bt,{id:(0,C.SU)(a)},null,8,["id"])]),(0,n._)("div",Et,[o.value?(0,n.kq)("",!0):((0,n.wg)(),(0,n.iD)("div",$t)),o.value?((0,n.wg)(),(0,n.iD)("h4",At,(0,P.zw)(o.value),1)):(0,n.kq)("",!0),(0,n._)("p",null,(0,P.zw)(r.value),1)])]))}};const Yt=(0,o.Z)(Ft,[["__scopeId","data-v-039f6be4"]]);var Kt=Yt;const Jt={id:"message",class:"flex flex-row mb-3 animate-pulse"},Gt=(0,n.uE)('<div class="flex-shrink-0 p-2"><div class="rounded-full w-12 h-12 bg-gray-600"></div></div><div class="flex flex-col flex-wrap text-left m-2 space-y-2"><div class="w-16 h-6 rounded-md bg-gray-600"></div><div class="w-80 h-8 rounded-md bg-gray-600"></div></div>',2),Xt=[Gt];function Qt(e,t){return(0,n.wg)(),(0,n.iD)("div",Jt,Xt)}const es={},ts=(0,o.Z)(es,[["render",Qt]]);var ss=ts;const as={class:"flex-grow flex flex-col items-stretch",id:"messages-field"},ns={class:"mb-auto text-left text-lg shadow-md bg-gray-700 font-bold p-3"},rs={key:0,class:"text-gray-300"},os={key:1,class:"animate-pulse bg-gray-600 rounded-md w-20 h-6"},ls={key:0,id:"message-container",class:"flex flex-col w-100 snap-y bg-gray-00"},is={key:0,class:"flex flex-col p-2 ml-3 space-y-2 text-left"},us={class:"text-gray-100 text-3xl font-bold w-fit"},cs={class:"text-gray-300"};var ds={__name:"MessagesList",setup(e){const t=(0,C.iH)("Veuillez sélectionner un channel"),s=(0,c.tv)(),a=(0,C.iH)(!1),r=(0,C.iH)([]),o=(0,j.oR)();let l=(0,C.iH)(null).value;function i(e,t,s){r.value.push({user:e,channel:t,text:s}),ct.sendMessage(e,t,s),(0,n.Y3)((()=>{u()}))}function u(){const e=document.querySelector("#message-container");e.scrollTo(0,e.scrollHeight)}(0,n.m0)((async()=>{const e=s.currentRoute.value,n=e.params.id;e.path.includes("server")&&n?(l=n,o.getters["message/getMessagesByChannelId"](l)||(a.value=!0,await o.dispatch("message/fetchMessages",l)),r.value=o.getters["message/getMessagesByChannelId"](l),t.value=o.getters["message/getChannelNameById"](l)):e.path.includes("personal")||ln.push("/main/server"),a.value=!1}));const d=setInterval((async()=>{l&&await o.dispatch("message/fetchMessages",l)}),5e3);return(0,n.Jd)((()=>{clearInterval(d)})),(e,o)=>{const l=(0,n.up)("font-awesome-icon");return(0,n.wg)(),(0,n.iD)("div",as,[(0,n._)("div",ns,[a.value?(0,n.kq)("",!0):((0,n.wg)(),(0,n.iD)("h2",rs,[(0,n.Wm)(l,{icon:["fa","hashtag"],class:"text-gray-500"}),(0,n.Uk)(" "+(0,P.zw)(t.value),1)])),a.value?((0,n.wg)(),(0,n.iD)("div",os)):(0,n.kq)("",!0)]),(0,C.SU)(s).currentRoute.value.params.id?((0,n.wg)(),(0,n.iD)("div",ls,[a.value?(0,n.kq)("",!0):((0,n.wg)(),(0,n.iD)("div",is,[(0,n.Wm)(l,{icon:["fa","hashtag"],class:"p-4 rounded-full text-3xl w-10 h-10 bg-gray-600 text-gray-300"}),(0,n._)("h2",us,"Bienvenue dans #"+(0,P.zw)(t.value)+"!",1),(0,n._)("h3",cs,"C'est le début du salon #"+(0,P.zw)(t.value)+".",1)])),((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(r.value,(e=>((0,n.wg)(),(0,n.j4)(Kt,{key:e.id,userId:e.user,message:e.text},null,8,["userId","message"])))),128)),a.value?((0,n.wg)(),(0,n.j4)(ss,{key:1})):(0,n.kq)("",!0)])):(0,n.kq)("",!0),(0,n.Wm)(Lt,{onSendMessage:i})])}}};const ms=ds;var ps=ms;const gs={class:"p-2 rounded-sm text-md font-bold text-yellow-400"};var fs={__name:"UserComponent",props:{userId:{type:Number,required:!0},username:{type:String,required:!0},link:{type:String,required:!0}},setup(e){const t=e,s=(0,C.iH)(t.username).value,a=(0,C.iH)(t.userId).value,r=(0,C.iH)(t.link).value;return(e,t)=>{const o=(0,n.up)("router-link");return(0,n.wg)(),(0,n.j4)(o,{to:"/main/personal/user/"+(0,C.SU)(a),class:"p-2 rounded-md flex items-center cursor-pointer hover:bg-gray-700"},{default:(0,n.w5)((()=>[(0,n.Wm)(Bt,{id:(0,C.SU)(a),link:(0,C.SU)(r)},null,8,["id","link"]),(0,n._)("h4",gs,(0,P.zw)((0,C.SU)(s)),1)])),_:1},8,["to"])}}};const vs=fs;var hs=vs;const ws={class:"flex flex-col"},xs=(0,n.uE)('<div class="flex flex-row rounded-md animate-pulse"><div class="flex-shrink-0 p-2"><div class="rounded-full w-10 h-10 bg-gray-600"></div></div><span class="p-2 w-16 h-6 self-center rounded-md bg-gray-600"></span></div><div class="flex flex-row rounded-md animate-pulse"><div class="flex-shrink-0 p-2"><div class="rounded-full w-10 h-10 bg-gray-600"></div></div><span class="p-2 w-28 h-6 self-center rounded-md bg-gray-600"></span></div><div class="flex flex-row rounded-md animate-pulse"><div class="flex-shrink-0 p-2"><div class="rounded-full w-10 h-10 bg-gray-600"></div></div><span class="p-2 w-10 h-6 self-center rounded-md bg-gray-600"></span></div>',3),ys=[xs];function bs(e,t){return(0,n.wg)(),(0,n.iD)("div",ws,ys)}const _s={},ks=(0,o.Z)(_s,[["render",bs]]);var Us=ks;const qs={id:"users",class:"w-fit"},Ss=(0,n._)("h2",{class:"p-2"},"Utilisateurs",-1),Cs={class:"p-2 flex flex-col mb-3",id:"users-list"},Ps={key:1};var js={__name:"UsersList",setup(e){const t=(0,C.iH)([]),s=(0,C.iH)(!1);return(0,n.bv)((async()=>{s.value=!0,await pt.getUsers().then((e=>{t.value=e,t.value.sort((function(e,t){const s=e.username.toUpperCase(),a=t.username.toUpperCase();let n=0;return s>a?n=1:s<a&&(n=-1),n}))})).catch((e=>{e.response&&403===e.response.status&&it.dispatch("logout")})),s.value=!1})),(e,a)=>((0,n.wg)(),(0,n.iD)("div",qs,[Ss,(0,n._)("div",Cs,[s.value?((0,n.wg)(),(0,n.j4)(Us,{key:0})):(0,n.kq)("",!0),s.value?(0,n.kq)("",!0):((0,n.wg)(),(0,n.iD)("div",Ps,[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(t.value.sort(),(e=>((0,n.wg)(),(0,n.j4)(hs,{username:e.username,key:e.id,userId:e.id,link:e.picture},null,8,["username","userId","link"])))),128))]))])]))}};const Ds=js;var Hs=Ds;const Is={id:"alert-1",class:"animate-slide-in-top fixed self-center w-fit flex p-4 mb-4 rounded-lg bg-gray-800 text-blue-400",role:"alert"},Vs=(0,n._)("svg",{"aria-hidden":"true",class:"flex-shrink-0 w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20",xmlns:"http://www.w3.org/2000/svg"},[(0,n._)("path",{"fill-rule":"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z","clip-rule":"evenodd"})],-1),Ws=(0,n._)("span",{class:"sr-only"},"Info",-1),Ms={class:"ml-3 text-sm font-medium"};var Ls={__name:"AlertComponent",props:{info:{type:String,required:!0}},setup(e){const t=e;return(e,s)=>((0,n.wg)(),(0,n.iD)("div",Is,[Vs,Ws,(0,n._)("div",Ms,(0,P.zw)(t.info),1)]))}};const Rs=Ls;var Ts=Rs;const Ns={class:"absolute w-auto p-2 m-2 min-w-max rounded-md shadow-md text-gray-100 bg-gray-900 text-sm font-bold transition-all duration-100 scale-0 group-hover:scale-100"};var zs={__name:"ToolTip",props:{title:{type:String,required:!0}},setup(e){const t=e;return(e,s)=>((0,n.wg)(),(0,n.iD)("span",Ns,(0,P.zw)(t.title),1))}};const Bs=zs;var Zs=Bs;const Os={id:"profile",class:"p-2"},Es={class:"flex flex-row items-center"},$s={class:"px-2 font-bold"};var As={__name:"ProfileBanner",setup(e){const t=(0,j.oR)(),s=(0,C.iH)(""),a=(0,C.iH)(t.getters["auth/getUser"].id),r=async()=>{t.dispatch("auth/logout"),ln.push("/login")},o=async()=>{const e=t.getters["auth/getUser"];e&&e.id&&(a.value=e.id,await pt.getUserById(e.id).then((e=>{s.value=e.username})).catch((e=>{s.value="undefined",console.warn(e)})))};return(0,n.bv)((async()=>{await o()})),(e,t)=>{const o=(0,n.up)("font-awesome-icon");return(0,n.wg)(),(0,n.iD)("div",Os,[(0,n._)("div",Es,[(0,n._)("a",{onClick:t[0]||(t[0]=t=>e.$emit("show-modal")),class:"flex flex-row justify-center items-start p-2 w-44 group cursor-pointer"},[(0,n.Wm)((0,C.SU)(Bt),{id:a.value},null,8,["id"]),(0,n._)("p",$s,(0,P.zw)(s.value),1),(0,n.Wm)(Zs,{class:"origin-bottom bottom-14",title:"Modifier le profil"})]),(0,n._)("a",{onClick:t[1]||(t[1]=e=>r()),class:"p-2 ms-auto group cursor-pointer"},[(0,n.Wm)(Zs,{title:"Déconnexion",class:"origin-bottom bottom-14 left-60"}),(0,n.Wm)(o,{icon:["fas","sign-out-alt"]})])])])}}};const Fs=(0,o.Z)(As,[["__scopeId","data-v-246a2b01"]]);var Ys=Fs;s(2062);const Ks={class:"fixed z-10 inset-0 overflow-y-auto"},Js={class:"flex items-center justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0"},Gs=(0,n._)("div",{class:"fixed inset-0 transition-opacity","aria-hidden":"true"},[(0,n._)("div",{class:"absolute inset-0 bg-gray-500 opacity-75"})],-1),Xs={class:"inline-block align-bottom bg-gray-700 text-gray-200 rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-lg sm:w-full"},Qs={class:"px-4 pt-5 pb-4 sm:p-6 sm:pb-4"},ea={class:"mt-3 text-center sm:mt-0 sm:ml-4 sm:text-left"},ta={class:"text-xl text-center leading-6 font-medium text-gray-200"},sa={key:0},aa={class:"space-y-6 flex flex-row"},na={class:"hover:opacity-50 w-fit h-fit self-center mr-10"},ra=["src"],oa={class:"flex flex-col justify-end w-full space-y-4"},la=(0,n._)("label",{for:"username",class:"block mb-2 text-sm font-medium text-gray-200 dark:text-white"},"Pseudo",-1),ia=(0,n._)("label",{for:"email",class:"block mb-2 text-sm font-medium text-gray-200 dark:text-white"},"Ton email",-1),ua=(0,n._)("label",{for:"password",class:"block mb-2 text-sm font-medium text-gray-200 dark:text-white"},"Ton mot de passe",-1),ca={class:"flex flex-row"},da={class:"flex flex-row justify-end mt-5"},ma={type:"submit",class:"w-full inline-flex justify-center rounded-md border border-transparent shadow-sm px-4 py-2 bg-purple-500 text-base font-medium text-white hover:bg-purple-600 duration-200 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 sm:ml-3 sm:w-auto sm:text-sm"},pa={key:0},ga={key:1},fa={class:"flex flex-col justify-end w-full space-y-4"},va=(0,n._)("label",{for:"currentPassword",class:"block mb-2 text-sm font-medium text-gray-200 dark:text-white"}," Mot de passe actuel ",-1),ha={class:"flex flex-row"},wa=(0,n._)("label",{for:"newPassword",class:"block mb-2 text-sm font-medium text-gray-200 dark:text-white"}," Nouveau mot de passe",-1),xa={class:"flex flex-row"},ya={class:"mb-3"},ba=(0,n._)("span",{class:"mb-2 text-white font-semibold"},"Votre mot de passe doit contenir au moins:",-1),_a={class:"list-none text-white"},ka=(0,n._)("label",{for:"confirmPassword",class:"block mb-2 text-sm font-medium text-gray-200 dark:text-white"},"Confirmer le nouveau mot de passe",-1),Ua={class:"flex flex-row"},qa={class:"flex flex-row justify-end mt-5"},Sa={type:"submit",class:"w-full inline-flex justify-center rounded-md border border-transparent shadow-sm px-4 py-2 bg-purple-500 text-base font-medium text-white hover:bg-purple-600 duration-200 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 sm:ml-3 sm:w-auto sm:text-sm"},Ca={key:0},Pa={key:1},ja={key:1,class:"p-3 text-red-700 text-center"},Da={key:0,class:"font-bold text-3xl"},Ha={key:1,class:"text-2xl"},Ia=(0,n._)("span",{class:"font-bold"},"IRRÉVERSIBLE",-1),Va={key:2,class:"text-xl text-gray-200"},Wa=(0,n._)("br",null,null,-1),Ma={key:0},La={key:3,class:"flex flex-row px-3 mt-5 text-gray-200"},Ra=["disabled"],Ta={key:0},Na={key:1},za={key:2,class:"text-red-700 font-bold text-bold col-span-12 text-center mt-3"};var Ba={__name:"ProfileSettings",emits:["close","info-message"],setup(e,{emit:t}){const s=(0,j.oR)();function a(){t("close")}const r=(0,C.iH)(s.getters["auth/getUser"].id).value,o=(0,C.iH)(""),l=(0,C.iH)(!1),i=(0,C.iH)(null),u=(0,C.iH)(null),d=(0,C.iH)(""),m=(0,C.iH)(""),p=(0,C.iH)(""),g=(0,C.iH)(!1),f=(0,C.iH)(!1),v=(0,C.iH)(!1),h=(0,C.iH)(!1),w=(0,C.iH)(3),x=(0,C.iH)(""),y=(0,c.tv)(),b=(0,C.iH)(g.value?"Modifier votre mot de passe":"Modifier votre profil"),_=H.Ry().shape({username:H.Z_().required("Un nom d'utilisateur est requis!").min(3,"Le pseudo doit faire 3 caractères minimum!").max(20,"Le pseudo doit faire 20 characteres maximum!"),email:H.Z_().required("Un email est requis!").email("Cet email n'est pas valide!").max(50,"Cet email est trop long!"),password:H.Z_().required("Votre mot de passe est requis pour confirmer les changements!"),inputPicture:H.Z_().nullable()});function k(e){const t=e.target.files[0];u.value=URL.createObjectURL(t)}async function U(e){l.value=!0;try{await pt.updateProfile(r,e,u.value).then((async e=>{i.value&&await at.uploadProfilePic(r,i.value),t("info-message",e),a()})).catch((e=>{o.value=e}))}catch(s){o.value=s}l.value=!1}const q=H.Ry().shape({currentPassword:H.Z_().required("Votre mot de passe actuel est requis"),newPassword:H.Z_().required("Veuillez taper votre nouveau mot de passe").min(8,"Le mot de passe doit contenir au moins 8 caractères!").matches(/\d/,"Le mot de passe doit contenir au moins un chiffre").matches(/[$&+.,:;=?@#|'"<>^*ඞ()%!-]/,"Le mot de passe doit contenir au moins un caractère spécial"),confirmPassword:H.Z_().required("Veuillez confirmer votre nouveau mot de passe")});function S(){const e=/\d/;return e.test(x.value)}function I(){const e=/[$&+.,:;=?@#|'"<>^*ඞ()%!-]/;return e.test(x.value)}async function V(e){l.value=!0;try{await pt.updatePassword(r,e).then((async e=>{t("info-message",e),a()})).catch((e=>{o.value=e}))}catch(s){o.value=s}l.value=!1}async function W(){l.value=!0;try{await pt.deleteAccount(r).then((e=>{l.value=!1,h.value=!0,o.value=e.data.message,w.value=3;const t=setInterval((()=>{w.value--,0===w.value&&(clearInterval(t),s.dispatch("auth/logout"),y.push("/"))}),1e3)})).catch((e=>{o.value=e}))}catch(e){o.value=e}l.value=!1}return(0,n.bv)((async()=>{u.value=await at.getProfilePicture(r),await pt.getUserById(r).then((e=>{m.value=e.username,d.value=e.email})).catch((e=>{e.response&&403===e.response.status&&it.dispatch("logout")}))})),(0,n.YP)(v,(e=>{e&&setTimeout((()=>{v.value=!0}),3e3)})),(e,t)=>{const s=(0,n.up)("font-awesome-icon");return(0,n.wg)(),(0,n.iD)("div",Ks,[(0,n._)("div",Js,[Gs,(0,n._)("div",Xs,[(0,n._)("div",Qs,[(0,n._)("div",ea,[(0,n._)("h2",ta,(0,P.zw)(b.value),1),f.value?(0,n.kq)("",!0):((0,n.wg)(),(0,n.iD)("div",sa,[g.value?(0,n.kq)("",!0):((0,n.wg)(),(0,n.j4)((0,C.SU)(D.l0),{key:0,onSubmit:U,"validation-schema":(0,C.SU)(_)},{default:(0,n.w5)((()=>[(0,n._)("div",aa,[(0,n._)("div",na,[u.value?((0,n.wg)(),(0,n.iD)("img",{key:0,src:u.value,alt:"",id:"picture",class:"w-24 h-24 rounded-full fixed self-center"},null,8,ra)):(0,n.kq)("",!0),(0,n.Wm)((0,C.SU)(D.gN),{modelValue:i.value,"onUpdate:modelValue":t[0]||(t[0]=e=>i.value=e),name:"picture",onChange:k,type:"file",accept:".jpg,.jpeg,.gif,.png,.heic",id:"profile_picture",class:"opacity-0 w-24 h-24 cursor-pointer"},null,8,["modelValue"])]),(0,n._)("div",oa,[(0,n._)("div",null,[la,(0,n.Wm)((0,C.SU)(D.gN),{modelValue:m.value,"onUpdate:modelValue":t[1]||(t[1]=e=>m.value=e),type:"text",name:"username",class:"bg-colors-gray-form text-white w-full px-4 py-2 rounded-md border-none focus:border-blue-500 focus:outline-none",required:""},null,8,["modelValue"]),(0,n.Wm)((0,C.SU)(D.Bc),{name:"username",class:"text-red-700 font-bold"})]),(0,n._)("div",null,[ia,(0,n.Wm)((0,C.SU)(D.gN),{modelValue:d.value,"onUpdate:modelValue":t[2]||(t[2]=e=>d.value=e),type:"email",name:"email",class:"bg-colors-gray-form text-white w-full px-4 py-2 rounded-md border-none focus:border-blue-500 focus:outline-none",required:""},null,8,["modelValue"]),(0,n.Wm)((0,C.SU)(D.Bc),{name:"email",class:"text-red-700 font-bold"})]),(0,n._)("div",null,[ua,(0,n._)("div",ca,[(0,n.Wm)((0,C.SU)(D.gN),{modelValue:p.value,"onUpdate:modelValue":t[3]||(t[3]=e=>p.value=e),type:"password",name:"password",placeholder:"••••••••",class:"bg-colors-gray-form text-white w-full px-4 py-2 rounded-md border-none focus:border-blue-500 focus:outline-none",required:""},null,8,["modelValue"]),(0,n._)("button",{type:"button",onClick:t[4]||(t[4]=e=>g.value=!0),class:"w-full inline-flex justify-center rounded-md border border-transparent shadow-sm px-4 py-2 bg-purple-500 text-base font-medium text-white hover:bg-purple-600 duration-200 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 sm:ml-3 sm:w-auto sm:text-sm"}," Modifier")]),(0,n.Wm)((0,C.SU)(D.Bc),{name:"password",class:"text-red-700 font-bold"})])])]),(0,n._)("div",da,[(0,n._)("button",{type:"button",onClick:t[5]||(t[5]=e=>f.value=!0),class:"mx-auto mt-3 w-full inline-flex justify-center rounded-md shadow-sm px-4 py-2 border-red-600 border-2 text-base font-medium text-red-600 hover:bg-red-600 hover:text-gray-200 duration-200 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 sm:mt-0 ml-0 sm:w-auto sm:text-sm"}," Supprimer le compte "),(0,n._)("button",{type:"button",onClick:t[6]||(t[6]=e=>a()),class:"mt-3 w-full inline-flex justify-center rounded-md shadow-sm px-4 py-2 bg-gray-500 text-base font-medium text-gray-300 hover:bg-gray-600 duration-200 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 sm:mt-0 sm:ml-3 sm:w-auto sm:text-sm"}," Annuler "),(0,n._)("button",ma,[l.value?(0,n.kq)("",!0):((0,n.wg)(),(0,n.iD)("span",pa,"Appliquer")),l.value?((0,n.wg)(),(0,n.iD)("span",ga,[(0,n.Wm)(s,{icon:["fas","spinner"],spin:""})])):(0,n.kq)("",!0)])])])),_:1},8,["validation-schema"])),g.value?((0,n.wg)(),(0,n.j4)((0,C.SU)(D.l0),{key:1,onSubmit:V,"validation-schema":(0,C.SU)(q)},{default:(0,n.w5)((()=>[(0,n._)("div",fa,[(0,n._)("div",null,[va,(0,n._)("div",ha,[(0,n.Wm)((0,C.SU)(D.gN),{modelValue:e.currentPassword,"onUpdate:modelValue":t[7]||(t[7]=t=>e.currentPassword=t),type:"password",name:"currentPassword",placeholder:"••••••••",class:"bg-colors-gray-form text-white w-full px-4 py-2 rounded-md border-none focus:border-blue-500 focus:outline-none",required:""},null,8,["modelValue"])]),(0,n.Wm)((0,C.SU)(D.Bc),{name:"currentPassword",class:"text-red-700 font-bold"})]),(0,n._)("div",null,[wa,(0,n._)("div",xa,[(0,n.Wm)((0,C.SU)(D.gN),{modelValue:x.value,"onUpdate:modelValue":t[8]||(t[8]=e=>x.value=e),type:"password",name:"newPassword",placeholder:"••••••••",class:"bg-colors-gray-form text-white w-full px-4 py-2 rounded-md border-none focus:border-blue-500 focus:outline-none",required:""},null,8,["modelValue"])]),(0,n.Wm)((0,C.SU)(D.Bc),{name:"newPassword",class:"text-red-700 font-bold"})]),(0,n._)("div",ya,[ba,(0,n._)("ul",_a,[(0,n._)("li",{class:(0,P.C_)({"text-green-600":x.value.length>7})},[x.value.length>7?((0,n.wg)(),(0,n.j4)(s,{key:0,icon:["fa","check"],class:"text-green-600"})):(0,n.kq)("",!0),(0,n.Uk)(" 8 caractères ")],2),(0,n._)("li",{class:(0,P.C_)({"text-green-600":S()})},[S()?((0,n.wg)(),(0,n.j4)(s,{key:0,icon:["fa","check"],class:"text-green-600"})):(0,n.kq)("",!0),(0,n.Uk)(" Un chiffre ")],2),(0,n._)("li",{class:(0,P.C_)({"text-green-600":I()})},[I()?((0,n.wg)(),(0,n.j4)(s,{key:0,icon:["fa","check"],class:"text-green-600"})):(0,n.kq)("",!0),(0,n.Uk)(" Un caractère spécial ")],2)])]),(0,n._)("div",null,[ka,(0,n._)("div",Ua,[(0,n.Wm)((0,C.SU)(D.gN),{type:"password",name:"confirmPassword",placeholder:"••••••••",class:"bg-colors-gray-form text-white w-full px-4 py-2 rounded-md border-none focus:border-blue-500 focus:outline-none",required:""})]),(0,n.Wm)((0,C.SU)(D.Bc),{name:"confirmPassword",class:"text-red-700 font-bold"})]),(0,n._)("div",qa,[(0,n._)("button",{type:"button",onClick:t[9]||(t[9]=e=>g.value=!1),class:"mt-3 w-full inline-flex justify-center rounded-md shadow-sm px-4 py-2 bg-gray-500 text-base font-medium text-gray-300 hover:bg-gray-600 duration-200 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 sm:mt-0 sm:ml-3 sm:w-auto sm:text-sm"}," Retour "),(0,n._)("button",Sa,[l.value?(0,n.kq)("",!0):((0,n.wg)(),(0,n.iD)("span",Ca,"Appliquer")),l.value?((0,n.wg)(),(0,n.iD)("span",Pa,[(0,n.Wm)(s,{icon:["fas","spinner"],spin:""})])):(0,n.kq)("",!0)])])])])),_:1},8,["validation-schema"])):(0,n.kq)("",!0)])),f.value?((0,n.wg)(),(0,n.iD)("div",ja,[h.value?(0,n.kq)("",!0):((0,n.wg)(),(0,n.iD)("h1",Da,"ATTENTION: ÊTES-VOUS SÛR DE VOULOIR SUPPRIMER VOTRE COMPTE.")),h.value?(0,n.kq)("",!0):((0,n.wg)(),(0,n.iD)("h2",Ha,[(0,n.Uk)("Cette action est "),Ia])),o.value?((0,n.wg)(),(0,n.iD)("h1",Va,[(0,n.Uk)((0,P.zw)(o.value)+" ",1),Wa,h.value?((0,n.wg)(),(0,n.iD)("span",Ma," Redirection dans "+(0,P.zw)(w.value)+"... ",1)):(0,n.kq)("",!0)])):(0,n.kq)("",!0),h.value?(0,n.kq)("",!0):((0,n.wg)(),(0,n.iD)("div",La,[(0,n._)("button",{onClick:t[10]||(t[10]=e=>f.value=!1),class:"w-full inline-flex justify-center rounded-md border border-transparent shadow-sm px-4 py-2 bg-purple-500 text-xl font-medium text-white hover:bg-purple-600 duration-200 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 sm:ml-3 sm:w-auto"}," Annuler "),(0,n._)("button",{disabled:v.value,onClick:t[11]||(t[11]=e=>W()),class:"w-full inline-flex justify-center disabled:opacity-50 rounded-md border border-transparent shadow-sm px-4 py-2 bg-red-600 text-lg font-medium text-white hover:bg-red-700 duration-200 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 sm:ml-3 sm:w-auto"},[l.value?(0,n.kq)("",!0):((0,n.wg)(),(0,n.iD)("span",Ta," Supprimer mon compte 😢 ")),l.value?((0,n.wg)(),(0,n.iD)("span",Na,[(0,n.Wm)(s,{icon:["fas","spinner"],spin:""})])):(0,n.kq)("",!0)],8,Ra)]))])):(0,n.kq)("",!0),o.value&&!f.value?((0,n.wg)(),(0,n.iD)("p",za,(0,P.zw)(o.value),1)):(0,n.kq)("",!0)])])])])])}}};const Za=Ba;var Oa=Za,Ea={__name:"SideBarIcon",props:{name:{type:String,required:!0},icon:{type:Array,required:!0},id:{type:String,required:!0}},setup(e){const t=e;return(e,s)=>{const a=(0,n.up)("font-awesome-icon"),r=(0,n.up)("router-link");return(0,n.wg)(),(0,n.j4)(r,{to:"/main/"+t.id,class:(0,P.C_)([{selected:e.$route.path.includes(t.id)},"relative flex items-center justify-center h-12 w-12 mt-2 mb-2 mx-auto shadow-lg bg-gray-800 text-blue-600 hover:bg-blue-600 hover:text-gray-200 active:top-0.5 rounded-3xl hover:rounded-xl transition-all duration-200 ease-linear cursor-pointer group"])},{default:(0,n.w5)((()=>[(0,n.Wm)(Zs,{title:t.name,class:"origin-left left-14"},null,8,["title"]),(0,n.Wm)(a,{icon:t.icon,size:"xl"},null,8,["icon"])])),_:1},8,["to","class"])}}};const $a=(0,o.Z)(Ea,[["__scopeId","data-v-771336aa"]]);var Aa=$a;const Fa={class:"top-0 left-0 h-screen w-16 flex flex-col bg-primary text-secondary shadow-lg"};var Ya={__name:"SideBar",setup(e){return(e,t)=>((0,n.wg)(),(0,n.iD)("div",Fa,[(0,n.Wm)(Aa,{icon:["fab","discord"],name:"Messages privés",id:"personal"}),(0,n.Wm)(Aa,{icon:["fas","users"],name:"Serveur principal",id:"server"})]))}};const Ka=Ya;var Ja=Ka;const Ga={class:"flex flex-row h-screen",id:"discord"},Xa={class:"flex flex-row max-[768px]:hidden"},Qa={id:"channel",class:"flex flex-col"},en={class:"flex flex-col w-full"},tn={class:"flex flex-col max-[768px]:hidden"};var sn={__name:"MainView",setup(e){const t=(0,C.iH)(!1),s=(0,C.iH)(""),r=(0,j.oR)(),o=(0,c.tv)();function l(e){s.value=e,setTimeout((()=>{s.value=""}),3e3)}const i=()=>{r.dispatch("auth/logout"),o.push("/login")};return(0,n.bv)((()=>{it.on("logout",(()=>{i()}))})),(0,n.Jd)((()=>{it.remove("logout")})),(e,r)=>((0,n.wg)(),(0,n.iD)("div",Ga,[(0,n._)("div",Xa,[((0,n.wg)(),(0,n.j4)((0,n.LL)(Ja))),(0,n._)("div",Qa,[((0,n.wg)(),(0,n.j4)((0,n.LL)(Ht),{class:"grow",onInfoMessage:l},null,32)),((0,n.wg)(),(0,n.j4)((0,n.LL)(Ys),{onShowModal:r[0]||(r[0]=e=>t.value=!0)},null,32))])]),(0,n._)("div",en,[s.value?((0,n.wg)(),(0,n.j4)(Ts,{key:0,info:s.value},null,8,["info"])):(0,n.kq)("",!0),((0,n.wg)(),(0,n.j4)((0,n.LL)(ps)))]),(0,n._)("div",tn,[((0,n.wg)(),(0,n.j4)((0,n.LL)(Hs)))]),(0,n.Wm)(a.uT,{name:"fade"},{default:(0,n.w5)((()=>[t.value?((0,n.wg)(),(0,n.j4)((0,n.LL)(Oa),{key:0,onClose:r[1]||(r[1]=e=>t.value=!1),onInfoMessage:l},null,32)):(0,n.kq)("",!0)])),_:1})]))}};const an=sn;var nn=an;const rn=[{path:"/",name:"home",component:S},{path:"/main",name:"main",component:nn,children:[{path:"personal",name:"privateMessage",component:nn,children:[{path:"user/:id",component:nn}]},{path:"server",name:"server",component:nn,children:[{path:"channel/:id",component:nn}]}]},{path:"/login",name:"login",component:te},{path:"/register",name:"signup",component:Re}],on=(0,c.p7)({history:(0,c.PO)("/"),routes:rn});var ln=on,un=s(7749),cn=s(3494),dn=s(2234),mn=s(8321);cn.vI.add(mn.LM3,mn.olY,mn.LEp,dn.omb,mn.jLD,mn.FVb,mn.r8p,mn.XCy,mn.$aW),(0,a.ri)(u).use(ln).use(ht).component("font-awesome-icon",un.GN).mount("#app")}},t={};function s(a){var n=t[a];if(void 0!==n)return n.exports;var r=t[a]={exports:{}};return e[a].call(r.exports,r,r.exports,s),r.exports}s.m=e,function(){var e=[];s.O=function(t,a,n,r){if(!a){var o=1/0;for(c=0;c<e.length;c++){a=e[c][0],n=e[c][1],r=e[c][2];for(var l=!0,i=0;i<a.length;i++)(!1&r||o>=r)&&Object.keys(s.O).every((function(e){return s.O[e](a[i])}))?a.splice(i--,1):(l=!1,r<o&&(o=r));if(l){e.splice(c--,1);var u=n();void 0!==u&&(t=u)}}return t}r=r||0;for(var c=e.length;c>0&&e[c-1][2]>r;c--)e[c]=e[c-1];e[c]=[a,n,r]}}(),function(){s.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return s.d(t,{a:t}),t}}(),function(){s.d=function(e,t){for(var a in t)s.o(t,a)&&!s.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:t[a]})}}(),function(){s.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){var e={143:0};s.O.j=function(t){return 0===e[t]};var t=function(t,a){var n,r,o=a[0],l=a[1],i=a[2],u=0;if(o.some((function(t){return 0!==e[t]}))){for(n in l)s.o(l,n)&&(s.m[n]=l[n]);if(i)var c=i(s)}for(t&&t(a);u<o.length;u++)r=o[u],s.o(e,r)&&e[r]&&e[r][0](),e[r]=0;return s.O(c)},a=self["webpackChunkdiscordfront"]=self["webpackChunkdiscordfront"]||[];a.forEach(t.bind(null,0)),a.push=t.bind(null,a.push.bind(a))}();var a=s.O(void 0,[998],(function(){return s(1942)}));a=s.O(a)})();
//# sourceMappingURL=app.8b839cd4.js.map
